<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Future Levee Predictor</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/chartjs-plugin-annotation@1.1.0"></script>
<style>
  body { font-family: 'Helvetica Neue', sans-serif; margin: 0; padding: 0; }
  .container { display: flex; flex-direction: row; height: 100vh; }
  .sidebar { width: 30%; background: #f9f9f9; padding: 20px; overflow-y: auto; border-right: 1px solid #e0e0e0; }
  .map-container { flex: 1.4; position: relative; }
  #map { width: 100%; height: 100%; position: absolute; }
  select, table, button { width: 100%; margin-top: 10px; padding: 8px; border-radius: 8px; }
  .predict-btn, .download-btn { background-color: #6995c2; color: white; border: none; font-weight: bold; cursor: pointer; }
  .predict-result { margin-top: 20px; background: white; padding: 16px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: none; }
  table { border-collapse: collapse; }
  td, th { border: 1px solid #ccc; padding: 6px; text-align: center; }
</style>
</head>
<body>
<div class="container">
  <div class="sidebar">
    <h2 class="levee-title">Levee Predictor</h2>
    <select class="levee-select" onchange="selectLevee(this.value)">
      <option value="">Select site</option>
      <option value="Site 2">Site 2</option>
      <option value="Site 3">Site 3</option>
      <option value="Site 4">Site 4</option>
    </select>
    <div class="water-table-wrapper">
      <table id="water-table"></table>
    </div>
    <button class="predict-btn" onclick="predict()">Predict</button>
    <div id="loading-message" style="display:none; margin-top:2px; text-align:center; color:gray;">Please wait...</div>
    <div id="predict-result" class="predict-result">
      <canvas id="chartCanvas" width="400" height="300"></canvas>
      <button class="download-btn" onclick="downloadChart()">Download Chart</button>
      <div id="summary" style="margin-top:2px; font-size:16px;"></div>
    </div>
  </div>
  <div class="map-container">
    <div id="map"></div>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
<script>
let chart;

function initializeTable() {
  const table = document.getElementById('water-table');
  table.innerHTML = '<tr><th>Day</th><th>Level (ft)</th></tr>' +
    Array.from({length: 20}, (_,i)=>
      `<tr>
        <td>${i+1}</td>
        <td><input type="text" value="30" data-row="${i}" data-col="0" style="width:80px; text-align:center;"></td>
      </tr>`).join('');
}

function getTableData() {
  const table = document.getElementById('water-table');
  const inputs = table.querySelectorAll('input');
  const levels = [];
  inputs.forEach(input => {
    const value = parseFloat(input.value.trim());
    levels.push(isNaN(value) ? 0 : value);
  });
  return levels;
}

function downloadChart() {
  const link = document.createElement('a');
  link.download = 'levee_prediction_chart.png';
  link.href = chart.toBase64Image();
  link.click();
}

initializeTable();
</script>
</body>
</html>
